filenames = {
'saw/saw_1(1-5).aif',
'saw/saw_1(1-5).aif',
'saw/saw_2(6).aif',
'saw/saw_3(7).aif',
'saw/saw_4(8-10).aif',
'saw/saw_5(11-12).aif',
'saw/saw_6(13).aif',
'bell/bell_1(1-8).aif',
'bell/bell_2(9).aif',
'bell/bell_3(10).aif',
'bell/bell_3_1(12-13).aif',
'bell/bell_4(11).aif',  
'sine/sine(1-16).aif',
'square/square_1(1-5).aif',      
'square/square_2(6).aif',         
'square/square_3(7-8).aif',
'square/square_4(9-10).aif',
'square/square_5(11-12).aif',       
'square/square_6(13).aif',
'pulse/pulse_1(1-7).aif',    
'pulse/pulse_2(8).aif',          
'pulse/pulse_3(9).aif',        
'pulse/pulse_4(10).aif',
'pulse/pulse_5(11).aif',
'pulse/pulse_6(12).aif',
'pulse/pulse_7(13).aif',
'noise1/noise1(1-16).aif',
'noise2/noise2(1-16).aif',
'noise3/noise3(1-16).aif',
'bass/bass_1(1-8).aif',
'bass/bass_2(9).aif',
'bass/bass_3(10-11).aif',
'bass/bass_4(12-13).aif',
'piano/pianolow_1(1-5).aif',
'piano/pianolow_2(6).aif',
'piano/pianolow_3(7).aif',
'piano/pianohi_1(8).aif',
'piano/pianohi_2(9).aif',
'piano/pianohi_3(10).aif',
'piano/pianohi_4(11-12).aif',
'el_pno/el-pno_1(1-9).aif',
'el_pno/el-pno_3(12-13).aif',
'el_pno/el-pno_2(10-11).aif',
'voice1/voice_1(1-5).aif',        
'voice1/voice_2(6).aif',       
'voice1/voice_3(7).aif',        
'voice1/voice_4(8).aif',
'voice1/voice_5(9).aif',
'voice1/voice_6(10).aif',
'voice1/voice_7(11-12).aif',
'voice2/voice_1(1-5).aif',        
'voice2/voice_2(6).aif',       
'voice2/voice_3(7).aif',        
'voice2/voice_4(8).aif',
'voice2/voice_5(9).aif',
'voice2/voice_6(10).aif',
'voice2/voice_7(11-12).aif',
'kick/kick(1-16).aif',
'reed/reed_1(1-7).aif',   
'reed/reed_2(8).aif',    
'reed/reed_3(9).aif',
'reed/reed_4(10).aif',
'reed/reed_5(11).aif',
'reed/reed_6(12).aif',
'reed/reed_7(13).aif',
'reed/reed_8(14).aif',
'organ/organ_1(1-11).aif',
'organ/organ_2(12-13).aif',
'synth1/synth1_1(1-9).aif',
'synth1/synth1_2(10).aif',
'synth1/synth1_3(11).aif',
'synth2/synth2_1(1-9).aif',
'synth2/synth2_2(10).aif',
'synth2/synth2_3(11).aif',
'synth3/synth3_1(1-10).aif',
'synth3/prime_synth3_2(11).aif',
'pulse2/pulse_6(12).aif', 
'pulse2/pulse_7(13).aif',
'sqr2/square_6(13).aif',
'4octs/organ_2(12-13).aif',
'prime/prime_synth3_2(1-12).aif',
'bass2/bass_3(10-11).aif',
'bass2/bass_4(12-13).aif',
'epno2/el-pno_3(12-13).aif',
'octave/octave(1-15).aif',
'oct+5/oct+5(1-14).aif',
'saw2/saw2(1-14).aif',
'triang/triang(1-14).aif',
'reed2/formant_6(7).aif',
'reed2/formant_7(8).aif',
'reed2/formant_8(9).aif',
'reed3/clav_4(10-11).aif',
'grit1/grit_2(6).aif',   
'grit1/grit_3(7).aif',         
'grit1/grit_4(8).aif',         
'grit1/grit_5(9).aif',
'grit1/grit_6(10).aif',
'grit1/grit_7(11).aif',
'grit1/grit_8(12-13).aif',
'grit2/grit_1(1-5).aif',      
'grit2/grit_2(6).aif',       
'grit2/grit_3(7).aif',         
'grit2/grit_4(8).aif',
'grit2/grit_5(9).aif',
'grit2/grit_6(10).aif',
'grit2/grit_7(11).aif',
'grit2/grit_8(12-13).aif',
'grit3/grit_1(1-5).aif',        
'grit3/grit_2(6).aif',       
'grit3/grit_3(7).aif',         
'grit3/grit_4(8).aif',
'grit3/grit_5(9).aif',
'grit3/grit_6(10).aif',
'grit3/grit_7(11).aif',
'grit3/grit_8(12-13).aif',
'glint1/sine(1-16).aif',
'glint2/sine(1-16).aif',
'clav/clav_1(1-7).aif',
'clav/clav_2(8).aif',
'clav/clav_3(9).aif',
'clav/clav_4(10-11).aif',
'brass/brass_1(1-8).aif',
'brass/brass_2(9-11).aif',
'brass/brass_3(12-13).aif',
'string/string_1(1-9).aif',
'string/string_2(10).aif',
'string/string_3(11).aif',
'string/string_4(12-13).aif',
'digit1/digit1_1(1-7).aif',
'digit1/digit1_2(10-11).aif',
'digit1/formant_5(6).aif',
'digit1/formant_6(7).aif',
'digit2/digit1_1(1-7).aif',
'digit2/digit1_2(10-11).aif',
'bell2/bell2_1(1-10).aif',
'bell2/bell2_2(11-13).aif',
'alien/alien_1(1-7).aif',
'alien/alien_2(8-9).aif',
'alien/alien_3(10).aif',
'alien/alien_4(11-13).aif',
'x_ter/kupo(1-16).aif',
'formant1/formant_1(1-2).aif',
'formant1/formant_2(3).aif',
'formant1/formant_3(4).aif',
'formant1/formant_4(5).aif',
'formant1/formant_5(6).aif',
'formant1/formant_6(7).aif',
'formant1/formant_7(8).aif',
'formant1/formant_8(9).aif',
'formant1/formant_9(10).aif',
'formant2/formant_1(1-2).aif',   
'formant2/formant_2(3).aif',    
'formant2/formant_3(4).aif',      
'formant2/formant_4(5).aif',      
'formant2/formant_5(6).aif',
'formant2/formant_6(7).aif',
'formant2/formant_7(8).aif',
'formant2/formant_8(9).aif',
'formant3/formant_1(1-2).aif',    
'formant3/formant_2(3).aif',  
'formant3/formant_3(4).aif',      
'formant3/formant_4(5).aif',      
'formant3/formant_5(6).aif',
'formant3/formant_6(7).aif',
'formant3/formant_7(8).aif',
'formant3/formant_8(9).aif',
'formant4/formant_1(1-2).aif',
'formant4/formant_2(3).aif',
'formant4/formant_3(4).aif',
'formant4/formant_4(5).aif',
'formant4/formant_5(6).aif',
'formant4/formant_6(7).aif',
'formant4/formant_7(8).aif',
'formant4/formant_8(9).aif',
'formant5/formant_1(1-2).aif',      
'formant5/formant_2(3).aif',    
'formant5/formant_3(4).aif',      
'formant5/formant_4(5).aif',      
'formant5/formant_5(6).aif',
'formant5/formant_6(7).aif',
'formant5/formant_7(8).aif',
'formant5/formant_8(9).aif'
}

figure

for ii = 1:length(filenames),
  disp(filenames{ii});
  xx = audioread(filenames{ii});
  N = length(xx)
  fftxx = fft(xx);
  harm = fftxx(2:N/2) / N;
  magharm = abs(harm);
  threshold = 0.005 * max(magharm);
  maxharm = max((1:length(harm))' .* (magharm > threshold));
  subplot(2,2,1);
  plot(xx); axis tight; 
  title(filenames{ii}, 'Interpreter', 'none');
  subplot(2,2,3);
  stem(magharm,'marker','.'); axis tight; 
  title('Harmonic magnitudes')
  subplot(2,2,2);
  stem(magharm(1:maxharm),'marker','.'); axis tight;
  title(['Max harmonic number = ', num2str(maxharm)]);
  subplot(2,2,4);
  stem(angle(harm(1:maxharm)) / pi,'marker','.'); axis tight;
  title('Harmonic phases/\pi','interpreter','tex')
  newfilename = strrep(strrep(filenames{ii},'/','_wave_'),'.aif','.pdf');
  print(newfilename,"-dpdfcrop");
end